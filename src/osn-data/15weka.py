#!/usr/bin/python

import csv
import json
        
with open('/vagrant/data/osn-data/ids.json', 'r') as file:
  ids = json.load(file)

ids = [10045092, 1007531, 101496212, 1021239846, 102464379, 103114245, 104852013, 10521002, 106104712, 108944858, 109223169, 10929372, 109485267, 110808568, 11126582, 111454868, 113441429, 11437162, 115073079, 115138473, 115171979, 11661442, 117093537, 117562901, 1177083624, 117870724, 118459389, 118474054, 11922222, 119436439, 119773854, 11987272, 119979433, 120268489, 12091872, 121768977, 122737979, 1236198937, 123745496, 124849194, 12584222, 1262051, 12681982, 12736092, 127828353, 12865902, 129720477, 1297731522, 1315286089, 132191278, 13234182, 13275052, 133165344, 133794989, 13385712, 13460112, 134682826, 13630552, 1371201120, 137123695, 13746182, 13955342, 140289159, 14052274, 14103278, 14108665, 141219265, 14216821, 14223726, 14229632, 14238085, 142406505, 142683977, 14292363, 14311409, 14326247, 14329827, 14341596, 14353656, 14372464, 14372827, 14503693, 14506340, 14558776, 14610613, 14683259, 14685524, 147029225, 14727300, 14760624, 14812945, 14852278, 14900774, 14901281, 14945279, 14981286, 1498798484, 15030109, 15048222, 150693965, 15121058, 15153365, 15164780, 151742290, 15226317, 15227820, 15232993, 15261709, 15276360, 15295567, 15300227, 15307110, 153559771, 15370082, 15412985, 15413409, 15446261, 15464753, 15473636, 15482020, 15507115, 15526160, 15676300, 15725056, 15844952, 15852942, 15868593, 15894712, 16090559, 16097172, 16133557, 16188096, 16205956, 16218208, 16242432, 16264556, 163554714, 16381466, 164266156, 16427456, 16440181, 1644226526, 16516286, 16525053, 16534580, 16539750, 16561108, 16568592, 16721983, 16754274, 167544646, 167979424, 16830304, 168752747, 16885564, 1690021310, 16925606, 16938477, 16983823, 17006237, 1707284881, 17264368, 17289508, 173246653, 17375954, 17395031, 17500378, 17563699, 17611773, 176684709, 17679900, 17680307, 17781987, 178183112, 178290294, 17850637, 17997140, 18034005, 18100365, 18107739, 18142778, 18162777, 18209777, 18262261, 18314186, 18332836, 18342516, 18377613, 18427709, 184696502, 186710373, 18671170, 18701575, 18727385, 18774603, 18802512, 18853460, 1886110453, 190284308, 190676679, 192285937, 19243536, 19245592, 19257498, 19273553, 193047373, 193055620, 193877435, 19388800, 194460357, 19457875, 194844686, 1956601, 1972501, 19840174, 19864426, 198787694, 19896022, 199082056, 19981283, 20022522, 20038514, 20071366, 20193817, 201991499, 20224255, 20421414, 20469720, 20540225, 2084821, 20910966, 20993312, 21018190, 21051121, 211455134, 211543157, 21172719, 21210758, 212732867, 21285604, 212991627, 21305689, 213170736, 21449222, 2151218504, 21522245, 21527558, 215464034, 21551845, 215538575, 2155451028, 21572497, 21580279, 216242374, 21645721, 21668323, 21689878, 21690682, 217243955, 21820444, 21841580, 21846563, 218915630, 21946201, 220842793, 22087330, 22097148, 222793383, 22336264, 224119575, 224950158, 22542076, 225671353, 2259666550, 22645597, 22653653, 22674525, 22723261, 22804043, 22811768, 22817477, 22839859, 22884262, 229033311, 22952120, 230470257, 23140784, 231435258, 231850668, 2330667330, 2342442247, 23446307, 234838196, 2361416437, 23645346, 23647445, 23672351, 23957246, 24071954, 24096002, 24272045, 24327327, 24376523, 24383600, 24390992, 2445862754, 24637189, 24656873, 24691627, 24916659, 2493269757, 251801850, 25197017, 25298225, 253608676, 25519141, 25533464, 25584144, 25617338, 25772199, 25777430, 25868964, 2587937208, 26010109, 260309594, 26059680, 26110977, 26111184, 26111925, 261283186, 26299238, 26836162, 26906039, 27015204, 270542169, 271549247, 2727484299, 272932351, 27328412, 275419943, 27560087, 27723901, 27797696, 27803846, 27906446, 279146998, 28035489, 281800166, 281987255, 28207983, 282400485, 28258368, 282618471, 28359041, 28388270, 2840628328, 28457912, 284867370, 28503503, 285877073, 28667128, 28744549, 28773485, 2885653782, 289677739, 29046663, 29207028, 292121179, 29263484, 29298602, 2940253151, 294893966, 29548394, 2962912317, 296954894, 2971829547, 29838696, 29873471, 29892110, 29934475, 30133362, 30226543, 3025016884, 30347402, 30576990, 30619344, 30863938, 309552238, 31159879, 314424424, 314615930, 31512916, 31555593, 32454230, 3270360024, 33506364, 33667217, 3394771, 34262883, 354899850, 35637918, 35704124, 365077428, 381671017, 39206945, 39316272, 39944028, 404906413, 4080133834, 409530974, 41416430, 41983195, 423862419, 42680864, 44100334, 453800657, 47133830, 47332084, 54991079, 55384716, 5565592, 56784216, 57730432, 59673118, 59726300, 59809965, 61012093, 61879870, 622391163, 6246252, 66833407, 70229724, 7078342, 71422674, 71450773, 754714, 76253342, 812208710, 82491794, 86924274, 902226338, 90716992, 930529742, 95232266, 95697465, 98119947]

for user_id in ids:
  r = '/vagrant/data/osn-data/features_step3/aggregated/{}.json'.format(user_id)
  w = '/vagrant/data/osn-data/features_step3/aggregated/weka/{}.csv'.format(user_id)

  with open(r, 'r') as file:
    byday_aggregated = json.load(file)

  with open(w, 'w', newline='', encoding='utf-8') as file:
    csv_writer = csv.writer(file, delimiter=',')
    csv_writer.writerow(['hashtags_count','mentions_count','favourites_count','media_count','source','week','day_night','active_passive','mentions','coordinates','top_mentions','target'])
    for key in sorted(byday_aggregated.keys()):
      csv_writer.writerow([
        byday_aggregated[key]['hashtags_count'],
        byday_aggregated[key]['mentions_count'],
        byday_aggregated[key]['favourites_count'],
        byday_aggregated[key]['media_count'],
        byday_aggregated[key]['source'],
        byday_aggregated[key]['week'],
        byday_aggregated[key]['day_night'],
        byday_aggregated[key]['active_passive'],
        byday_aggregated[key]['mentions'],
        byday_aggregated[key]['coordinates'],
        byday_aggregated[key]['top_mentions'],
        byday_aggregated[key]['_target']
      ])

w = '/vagrant/data/osn-data/features_step3/aggregated/weka/all.csv'.format(user_id)
with open(w, 'w', newline='', encoding='utf-8') as file:
  csv_writer = csv.writer(file, delimiter=',')
  csv_writer.writerow(['hashtags_count','mentions_count','favourites_count','media_count','source','week','day_night','active_passive','mentions','coordinates','top_mentions','target'])
  for user_id in ids:
    r = '/vagrant/data/osn-data/features_step3/aggregated/{}.json'.format(user_id)
    with open(r, 'r') as file:
      byday_aggregated = json.load(file)

    for key in sorted(byday_aggregated.keys()):
      csv_writer.writerow([
        byday_aggregated[key]['hashtags_count'],
        byday_aggregated[key]['mentions_count'],
        byday_aggregated[key]['favourites_count'],
        byday_aggregated[key]['media_count'],
        byday_aggregated[key]['source'],
        byday_aggregated[key]['week'],
        byday_aggregated[key]['day_night'],
        byday_aggregated[key]['active_passive'],
        byday_aggregated[key]['mentions'],
        byday_aggregated[key]['coordinates'],
        byday_aggregated[key]['top_mentions'],
        byday_aggregated[key]['_target']
      ])
